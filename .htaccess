# Отключаем индексацию директорий
Options -Indexes

# MIME для json (RemoveHandler/RemoveType убраны — они часто запрещены)
<IfModule mod_mime.c>
  AddType application/json .json
</IfModule>

# Запрет прямого доступа к служебным PHP-файлам
<FilesMatch "^(config|init|functions)\.php$">
  Require all denied
</FilesMatch>

# Запрет доступа к каталогу /data (через переписывание)
RewriteEngine On
RewriteRule ^data/ - [F,L]

# Если запрашивается реальный файл/папка — отдать как есть
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Не переписывать admin и api — отдать напрямую (в т.ч. /api/*.json)
RewriteRule ^(admin|api)/ - [L]


# Точка входа: всё остальное прокидываем в public/
DirectoryIndex public/index.html index.php index.html
RewriteRule ^(.*)$ public/$1 [L]